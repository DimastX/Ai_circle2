\documentclass[12pt, a4paper]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsmath, amssymb, amsfonts}
\usepackage{graphicx}
\usepackage{geometry}
\geometry{a4paper, margin=2cm}
\usepackage{indentfirst} % Для отступа первого абзаца
\usepackage{subcaption} % Для поддержки subfigure环境

\title{Теоретические основы моделирования транспортных потоков и анализ устойчивости}
% \author{Ваше Имя} % Вы можете раскомментировать и вписать свое имя
% \date{\today} % Вы можете раскомментировать для автоматической даты

\begin{document}
% \maketitle % Раскомментируйте, если хотите титульный лист
% \tableofcontents % Раскомментируйте, если хотите оглавление
% \newpage

\section{Введение в моделирование транспортных потоков}
\label{sec:intro_traffic_flow}

Транспортные потоки представляют собой сложные динамические системы, характеризующиеся взаимодействием большого числа индивидуальных агентов (водителей и их транспортных средств). Понимание закономерностей движения этих потоков, причин возникновения заторов и методов повышения эффективности и безопасности дорожного движения является одной из ключевых задач транспортной науки. Ежедневно миллионы людей сталкиваются с проблемами дорожных заторов, которые приводят к потере времени, увеличению расхода топлива и негативному воздействию на окружающую среду.

Моделирование транспортных потоков предоставляет мощный инструмент для анализа и прогнозирования поведения транспортных систем. Существует несколько уровней детализации при моделировании:
\begin{itemize}
    \item \textbf{Макроскопические модели}: Описывают транспортный поток как сплошную среду, аналогично течению жидкости, используя усредненные характеристики, такие как плотность, скорость и интенсивность потока. Примерами являются модель Лайтхилла-Уизема-Ричардса (LWR).
    \item \textbf{Микроскопические модели}: Рассматривают поведение каждого отдельного транспортного средства в потоке. Эти модели фокусируются на взаимодействии между соседними автомобилями, в частности, на процессе следования за лидером.
    \item \textbf{Мезоскопические модели}: Занимают промежуточное положение, описывая поведение групп транспортных средств или используя вероятностные подходы.
\end{itemize}

Микроскопические модели, несмотря на свою вычислительную сложность применительно к большим транспортным сетям, обладают рядом преимуществ. Они позволяют детально исследовать причины возникновения нестабильностей в потоке, таких как фантомные заторы (заторы, возникающие без видимых причин, например, сужений дороги или аварий), а также оценивать эффективность различных систем помощи водителю и стратегий управления движением.

Центральным элементом микроскопических моделей является \textbf{модель следования за автомобилем (car-following model)}. Эти модели описывают, как водитель регулирует скорость и ускорение своего автомобиля в зависимости от поведения впереди идущего транспортного средства (лидера), а также от дорожных условий и собственных предпочтений. За десятилетия исследований было предложено множество моделей следования, начиная от ранних моделей, основанных на простых правилах реакции (например, модели General Motors), и заканчивая более сложными моделями, учитывающими психологические аспекты поведения водителя и его способность предвидеть развитие дорожной ситуации.

В данной работе основное внимание уделяется одной из наиболее известных и широко используемых моделей следования – Интеллектуальной модели водителя (Intelligent Driver Model, IDM), а также ее расширениям и анализу устойчивости потока, описываемого этой моделью.

\section{Интеллектуальная модель водителя (IDM)}
\label{sec:idm_model}

Интеллектуальная модель водителя (IDM) была предложена Трейбером, Хеннеке и Хелбингом в 2000 году \cite{treiber2000idm}

\subsection{Уравнение движения IDM}
\label{subsec:idm_equation}

Для каждого автомобиля $i$ в потоке в момент времени $t$ основными характеристиками являются его координата $x_i(t)$ и скорость $v_i(t)$. Дистанция (чистый зазор) до впереди идущего автомобиля $i-1$ определяется как $s_i(t) = x_{i-1}(t) - x_i(t) - L$, где $L$ – длина автомобиля (предполагается одинаковой для всех автомобилей для упрощения, хотя может быть и индивидуальной). Относительная скорость автомобиля $i$ по отношению к лидеру $i-1$ определяется как $\Delta v_i(t) = v_i(t) - v_{i-1}(t)$. Положительное значение $\Delta v_i$ означает, что автомобиль $i$ догоняет лидера.

Динамика автомобиля $i$ в модели IDM описывается дифференциальным уравнением для его ускорения $dv_i/dt$:
\begin{equation}
\label{eq:idm_acceleration}
\frac{dv_i}{dt} = a \left[1 - \left(\frac{v_i}{v_0}\right)^\delta - \left( \frac{s^*(v_i, \Delta v_i)}{s_i} \right)^2 \right].
\end{equation}
Здесь $a$ – максимальное комфортное ускорение, $v_0$ – желаемая скорость на свободной дороге, $\delta$ – показатель степени ускорения. Функция $s^*(v_i, \Delta v_i)$ представляет собой так называемую «желаемую динамическую дистанцию» и будет подробно рассмотрена ниже.

Уравнение (\ref{eq:idm_acceleration}) состоит из двух основных частей, отражающих мотивацию водителя:
\begin{enumerate}
    \item \textbf{Компонент свободного ускорения}: $a \left[1 - \left(\frac{v_i}{v_0}\right)^\delta\right]$. Этот член описывает стремление водителя достичь желаемой скорости $v_0$, когда нет препятствий (т.е. когда дистанция $s_i$ очень велика, и второй член в скобках стремится к нулю). Ускорение максимально ($a$), когда скорость $v_i$ мала, и плавно уменьшается до нуля по мере приближения $v_i$ к $v_0$. Показатель $\delta$ определяет, насколько резко происходит это уменьшение.
    \item \textbf{Компонент торможения (взаимодействия с лидером)}: $-a \left( \frac{s^*(v_i, \Delta v_i)}{s_i} \right)^2$. Этот член описывает реакцию водителя на наличие впереди идущего автомобиля. Он вызывает торможение (отрицательное ускорение), интенсивность которого зависит от отношения желаемой дистанции $s^*$ к текущей дистанции $s_i$. Если текущая дистанция $s_i$ становится меньше желаемой $s^*$, этот член становится доминирующим и заставляет автомобиль замедляться. Квадратичная зависимость от отношения $s^*/s_i$ обеспечивает плавное, но достаточно сильное торможение при приближении к лидеру.
\end{enumerate}

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.8\linewidth]{EIDM.png} % Изображение закомментировано
% 	\caption{Схематическое представление взаимодействия автомобилей в модели IDM. Автомобиль $i$ следует за автомобилем $i-1$, поддерживая дистанцию $s_i$ и имея скорость $v_i$.}
% 	\label{fig:idm_schema}
% \end{figure}

\subsection{Желаемая динамическая дистанция $s^*$}
\label{subsec:s_star}

Функция желаемой динамической дистанции $s^*(v, \Delta v)$ является ключевым элементом модели IDM, отражающим «интеллектуальность» водителя. Она рассчитывается следующим образом:
\begin{equation}
\label{eq:s_star_idm}
s^*(v, \Delta v) = s_0 + T \cdot v + \frac{v \cdot \Delta v}{2 \sqrt{a \cdot b}}.
\end{equation}
Здесь $v$ – текущая скорость рассматриваемого автомобиля, $\Delta v = v - v_{lead}$ – его относительная скорость с лидером ($v_{lead}$ – скорость лидера).
Компоненты этой функции имеют следующий физический смысл:
\begin{itemize}
    \item $s_0$ – \textbf{минимальный зазор (jam distance)}. Это безопасный зазор, который водитель стремится поддерживать до переднего автомобиля, даже когда оба автомобиля стоят (например, в плотном заторе). Этот параметр учитывает длину автомобиля, возможные небольшие смещения и ошибки восприятия.
    \item $T \cdot v$ – \textbf{компонент безопасного временного интервала (safe time headway)}. Параметр $T$ представляет собой желаемое время реакции или время, которое водитель хочет иметь в запасе для безопасной остановки или маневра в случае внезапного торможения лидера. Произведение $vT$ – это расстояние, которое автомобиль пройдет за время $T$ со скоростью $v$. Этот компонент обеспечивает линейное увеличение желаемой безопасной дистанции с ростом скорости, что соответствует реальному поведению большинства водителей.
    \item $\frac{v \cdot \Delta v}{2 \sqrt{a \cdot b}}$ – \textbf{динамический (интеллектуальный) член}. Этот компонент моделирует способность водителя адаптировать желаемую дистанцию в зависимости от динамики относительного движения.
    \begin{itemize}
        \item Если $\Delta v > 0$ (автомобиль догоняет лидера, т.е. $v > v_{lead}$), то этот член положителен, что приводит к увеличению $s^*$. Это заставляет водителя тормозить заблаговременно и более интенсивно, чтобы избежать слишком близкого приближения.
        \item Если $\Delta v < 0$ (автомобиль отстает от лидера, т.е. $v < v_{lead}$), то этот член отрицателен, что может приводить к уменьшению $s^*$. Это позволяет водителю несколько сократить дистанцию, если лидер удаляется.
        \item Если $\Delta v = 0$ (скорости равны), этот член равен нулю, и $s^* = s_0 + vT$.
    \end{itemize}
    Параметр $b$ в знаменателе – это \textbf{комфортное торможение (comfort deceleration)}, представляющее собой максимальное замедление, которое водитель считает комфортным в штатной ситуации. Сочетание $a$ и $b$ в знаменателе $\sqrt{ab}$ связывает этот адаптивный зазор со способностью автомобиля и водителя изменять скорость. Этот член отражает оценку водителем расстояния, необходимого для компенсации разницы скоростей без чрезмерно резких маневров.
\end{itemize}
В некоторых вариантах модели IDM, особенно при анализе ситуаций, где возможны очень резкие торможения лидера, динамический член может быть заключен в функцию $\max(0, \dots)$, чтобы желаемая дистанция $s^*$ не становилась меньше $s_0$:
\[ s^*(v, \Delta v) = s_0 + \max\left(0, T \cdot v + \frac{v \cdot \Delta v}{2 \sqrt{a \cdot b}}\right). \]
Однако для анализа равновесных состояний и линейной устойчивости, где $\Delta v \approx 0$, это различие часто не является существенным. В дальнейшем мы будем использовать формулу (\ref{eq:s_star_idm}).

\subsection{Параметры модели IDM и их физический смысл}
\label{subsec:idm_parameters}

Модель IDM характеризуется набором параметров, каждый из которых имеет четкий физический смысл и может быть откалиброван на основе реальных траекторных данных. Основные параметры модели:
\begin{itemize}
    \item $v_0$ (\textbf{желаемая скорость}, м/с): Скорость, которую водитель стремится поддерживать на свободной дороге при отсутствии других транспортных средств или ограничений. Зависит от типа дороги, установленных ограничений скорости, погодных условий, а также индивидуальных предпочтений водителя (агрессивный/осторожный).
    \item $T$ (\textbf{желаемый безопасный временной интервал}, с): Время, которое водитель предпочитает иметь между собой и впереди идущим автомобилем. Типичные значения лежат в диапазоне 0.8 – 2.5 секунды. Более высокое значение $T$ соответствует более осторожному стилю вождения.
    \item $a$ (\textbf{максимальное комфортное ускорение}, м/с²): Максимальное ускорение, которое водитель готов применить в идеальных условиях (свободная дорога, нет препятствий). Отражает как динамические возможности автомобиля, так и агрессивность водителя. Типичные значения: 0.5 – 3.5 м/с².
    \item $b$ (\textbf{комфортное торможение}, м/с²): Абсолютное значение замедления, которое водитель считает комфортным при обычном торможении. Не следует путать с экстренным торможением. Типичные значения: 1.0 – 4.5 м/с². Этот параметр важен для расчета динамического члена в $s^*$.
    \item $\delta$ (\textbf{показатель степени ускорения}, безразмерный): Определяет, насколько резко ускорение уменьшается по мере приближения текущей скорости $v$ к желаемой скорости $v_0$. Обычно используется значение $\delta = 4$, которое обеспечивает реалистичное поведение: плавное приближение к $v_0$ без значительного "перерегулирования". При $\delta=1$ получается экспоненциальное приближение, при $\delta \to \infty$ – режим постоянного ускорения до $v_0$ и затем резкая его стабилизация.
    \item $s_0$ (\textbf{минимальный зазор}, м): Минимальное расстояние (чистый зазор между задним бампером лидера и передним бампером следующего автомобиля), которое водитель поддерживает в полностью остановленном потоке (например, в пробке). Типичные значения: 1 – 5 метров.
    \item $L$ (\textbf{длина транспортного средства}, м): Физическая длина автомобиля. Используется для пересчета между чистым зазором $s_i$ и полным межцентровым расстоянием $h_i = s_i + L$. Часто для упрощения принимается среднее значение для всех ТС.
\end{itemize}

Выбор этих параметров оказывает существенное влияние на поведение моделируемого транспортного потока, включая его пропускную способность, стабильность и характер возникающих заторов. Калибровка параметров IDM является важной задачей при применении модели для конкретных дорожных условий или типов водителей.

\paragraph{Параметры IDM в симуляционных экспериментах.}
В симуляционных экспериментах, описываемых далее (см. разделы \ref{subsec:simulation_stability_idm} и \ref{subsec:simulation_vsl}), для модели IDM по умолчанию использовались параметры, представленные в Таблице \ref{tab:idm_default_params_sim}. Эти значения также соответствуют константе `DEFAULT_IDM_PARAMS` в скрипте `eidm_stability_analysis.py`, если не указано иное при описании конкретного сценария.

\begin{table}[h!]
\centering
\caption{Базовые параметры модели IDM, используемые в симуляциях по умолчанию.}
\label{tab:idm_default_params_sim}
\begin{tabular}{|l|c|c|}
\hline
\textbf{Параметр} & \textbf{Обозначение} & \textbf{Значение по умолчанию} \\\\
\hline
Желаемая скорость & $v_0$ & 33.3 м/с (120 км/ч) \\\\
Безопасный временной интервал & $T$ & 1.6 с \\\\
Максимальное ускорение & $a$ & 2.5 м/с$^2$ \\\\
Комфортное торможение & $b$ & 4.6 м/с$^2$ \\\\
Экспонента ускорения & $\delta$ & 4 \\\\
Минимальный чистый зазор & $s_0$ & 2.0 м \\\\
Длина автомобиля & $L$ & 5.0 м \\\\
\hline
\end{tabular}
\end{table}

В ходе экспериментов отдельные параметры IDM (например, безопасный временной интервал $T$ или желаемая скорость $v_0$ при анализе VSL) могли целенаправленно варьироваться для изучения их влияния на устойчивость потока или для моделирования управляющих воздействий. Генерация транспортного потока на симулируемой сети (например, кольцевой дороге) осуществлялась либо заданием фиксированного количества транспортных средств $N$, либо расчетом $N$ исходя из целевого равновесного зазора для достижения определенной плотности или состояния потока.

\section{Равновесные состояния в модели IDM}
\label{sec:equilibrium_states}

Равновесное состояние в транспортном потоке характеризуется тем, что все автомобили движутся с одинаковой постоянной скоростью $v_e$ (равновесная скорость) и поддерживают одинаковую постоянную дистанцию (чистый зазор) $s_e$ друг от друга. В таком состоянии ускорение каждого автомобиля равно нулю ($dv_i/dt = 0$), и относительная скорость между любыми двумя последовательными автомобилями также равна нулю ($\Delta v_i = 0$).

\subsection{Условия стационарности потока}
\label{subsec:equilibrium_conditions}

Для стационарного (равновесного) режима движения должны выполняться следующие условия для каждого автомобиля $i$:
\begin{enumerate}
    \item Ускорение равно нулю: $dv_i/dt = 0$.
    \item Относительная скорость отсутствует: $\Delta v_i = v_i - v_{i-1} = 0$, что означает $v_i = v_{i-1} = v_e$.
\end{enumerate}
Подставляя эти условия в уравнение IDM (\ref{eq:idm_acceleration}), получаем:
\begin{equation}
\label{eq:equilibrium_idm_raw}
0 = a \left[1 - \left(\frac{v_e}{v_0}\right)^\delta - \left( \frac{s^*(v_e, 0)}{s_e} \right)^2 \right].
\end{equation}
Поскольку параметр $a$ (максимальное ускорение) предполагается положительным ($a > 0$), выражение в квадратных скобках должно быть равно нулю:
\begin{equation}
\label{eq:equilibrium_condition_main}
1 - \left(\frac{v_e}{v_0}\right)^\delta - \left( \frac{s^*(v_e, 0)}{s_e} \right)^2 = 0.
\end{equation}
При $\Delta v = 0$, функция желаемой динамической дистанции (\ref{eq:s_star_idm}) упрощается:
\begin{equation}
\label{eq:s_star_equilibrium}
s^*(v_e, 0) = s_0 + T \cdot v_e.
\end{equation}
Подставляя это в (\ref{eq:equilibrium_condition_main}), получаем основное уравнение, описывающее равновесное состояние:
\begin{equation}
\label{eq:equilibrium_final_form}
\left(\frac{v_e}{v_0}\right)^\delta + \left( \frac{s_0 + T \cdot v_e}{s_e} \right)^2 = 1.
\end{equation}
Это уравнение связывает равновесную скорость $v_e$ и равновесный чистый зазор $s_e$ с параметрами модели IDM ($v_0, s_0, T, \delta$).

\subsection{Интерпретация равновесного состояния}
\label{subsec:equilibrium_interpretation}

Уравнение (\ref{eq:equilibrium_final_form}) можно интерпретировать как баланс двух стремлений водителя:
\begin{itemize}
    \item \textbf{Стремление к желаемой скорости}: Член $\left(v_e/v_0\right)^\delta$ отражает желание водителя двигаться с предпочтительной скоростью $v_0$. Если бы не было других автомобилей ($s_e \to \infty$), этот член должен был бы быть равен 1, что означало бы $v_e = v_0$.
    \item \textbf{Стремление к безопасной дистанции}: Член $\left( (s_0 + T \cdot v_e) / s_e \right)^2$ характеризует влияние необходимости поддерживать безопасную дистанцию до впереди идущего автомобиля. Этот член равен нулю, если $s_e \to \infty$. Если $s_e$ приближается к $s^*(v_e, 0) = s_0 + T v_e$, то этот член стремится к 1 (при $v_e \ll v_0$), что заставляет водителя снижать скорость.
\end{itemize}
В равновесном состоянии сумма этих двух (возведенных в соответствующую степень) "давления" равна единице. Если текущая скорость $v_e$ ниже желаемой $v_0$, первый член меньше 1, что означает, что автомобиль стремится ускориться. Однако это стремление ограничивается вторым членом, который отражает необходимость не слишком приближаться к лидеру.

В условиях очень свободного потока, когда $s_e$ очень велико, второй член становится пренебрежимо малым. Тогда $(v_e/v_0)^\delta \approx 1$, что означает $v_e \approx v_0$. Водитель движется со своей желаемой скоростью.
В условиях очень плотного потока, когда $v_e \to 0$, первый член стремится к нулю. Тогда $((s_0)/s_e)^2 \approx 1$, что означает $s_e \approx s_0$. Водители поддерживают минимальный зазор.

\subsection{Фундаментальная диаграмма и множественные состояния равновесия}
\label{subsec:fundamental_diagram_equilibrium}

Уравнение (\ref{eq:equilibrium_final_form}) неявно определяет так называемую \textbf{фундаментальную диаграмму} для модели IDM, которая представляет собой зависимость между макроскопическими параметрами потока: скоростью $v_e$, плотностью $\rho_e$ и интенсивностью (потоком) $q_e$.
Плотность $\rho_e$ связана с чистым зазором $s_e$ и длиной автомобиля $L$ как:
\begin{equation}
\label{eq:density_equilibrium}
\rho_e = \frac{1}{s_e + L}.
\end{equation}
Интенсивность потока $q_e$ определяется как:
\begin{equation}
\label{eq:flow_equilibrium}
q_e = \rho_e \cdot v_e = \frac{v_e}{s_e + L}.
\end{equation}

Из уравнения (\ref{eq:equilibrium_final_form}) можно выразить $s_e$ через $v_e$:
\[ \left( \frac{s_0 + T \cdot v_e}{s_e} \right)^2 = 1 - \left(\frac{v_e}{v_0}\right)^\delta \]
\[ \frac{s_0 + T \cdot v_e}{s_e} = \sqrt{1 - \left(\frac{v_e}{v_0}\right)^\delta} \]
\begin{equation}
\label{eq:se_from_ve}
s_e(v_e) = \frac{s_0 + T \cdot v_e}{\sqrt{1 - \left(\frac{v_e}{v_0}\right)^\delta}}.
\end{equation}
Это выражение определено для $0 \le v_e < v_0$. При $v_e = v_0$, знаменатель обращается в ноль, что соответствует $s_e \to \infty$ (свободный поток).
Используя $s_e(v_e)$, можно построить зависимости $q_e(v_e)$ или $q_e(\rho_e)$.

Важной особенностью модели IDM (как и многих других реалистичных моделей следования) является то, что фундаментальная диаграмма $q(\rho)$ является немонотонной. Она обычно имеет восходящую ветвь (свободный поток), достигает максимума (пропускная способность $q_{max}$ при критической плотности $\rho_{crit}$ и критической скорости $v_{crit}$), а затем нисходящую ветвь (плотный или синхронизованный поток, затор).

Это означает, что для заданного значения интенсивности потока $q < q_{max}$ может существовать два различных равновесных состояния:
\begin{enumerate}
    \item Состояние с высокой скоростью и низкой плотностью (на восходящей ветви фундаментальной диаграммы).
    \item Состояние с низкой скоростью и высокой плотностью (на нисходящей ветви).
\end{enumerate}
Наличие этих двух состояний играет ключевую роль в понимании феномена возникновения и распространения заторов. Переход между этими состояниями может быть вызван различными возмущениями в потоке.

Нахождение равновесных состояний ($v_e, s_e$) для заданного потока $q$ требует решения системы уравнений:
\begin{align}
\left(\frac{v_e}{v_0}\right)^\delta + \left( \frac{s_0 + T \cdot v_e}{s_e} \right)^2 &= 1 \label{eq:sys_eq1} \\
s_e &= \frac{v_e}{q} - L \label{eq:sys_eq2}
\end{align}
Подстановка (\ref{eq:sys_eq2}) в (\ref{eq:sys_eq1}) приводит к нелинейному уравнению относительно $v_e$, которое может иметь несколько решений (обычно два, одно или ни одного действительного положительного решения в зависимости от значения $q$ и параметров модели).

Физический смысл множественных состояний равновесия:
\begin{itemize}
    \item \textbf{Свободный поток}: Автомобили движутся с желаемой скоростью $v_0$ (или близкой к ней), расстояние между ними велико. Плотность потока низкая.
    \item \textbf{Синхронизированный (плотный) поток}: Автомобили движутся с одинаковой скоростью, меньшей $v_0$, и поддерживают стабильную дистанцию, определяемую равновесным условием. Плотность выше, чем в свободном потоке. Это состояние может возникать спонтанно из-за возмущений и является характерным для предзаторного состояния или установившегося затора.
    \item \textbf{Состояние "Stop-and-Go" (затор с остановками)}: Хотя это не является стационарным равновесным состоянием в строгом смысле (скорости не постоянны), оно часто возникает как результат нестабильности плотного потока. В этом состоянии автомобили периодически останавливаются и снова начинают движение. Средняя скорость очень низкая, а плотность очень высокая.
\end{itemize}
Причины существования множественных состояний и возможности перехода между ними кроются в нелинейности реакции водителей на изменение дорожной обстановки (зазора, относительной скорости) и в задержках реакции, которые могут приводить к перерегулированию и осцилляциям в потоке.

\section{Линеаризация и анализ устойчивости модели IDM}
\label{sec:linearization_stability}

Анализ устойчивости транспортного потока исследует, как малые возмущения (флуктуации скорости или дистанции одного или нескольких автомобилей) распространяются и эволюционируют во времени и пространстве. Если малые возмущения затухают, поток считается устойчивым. Если они нарастают, поток неустойчив, что может привести к формированию волн плотности, снижению средней скорости и, в конечном итоге, к образованию заторов типа "stop-and-go".

Линейный анализ устойчивости является стандартным методом исследования поведения системы вблизи состояния равновесия. Он включает линеаризацию нелинейных уравнений движения и последующий анализ характеристических уравнений для возмущений.

\subsection{Общая постановка задачи и функция ускорения}
\label{subsec:linearization_setup}

Рассмотрим цепочку автомобилей, следующих друг за другом. Уравнение движения для $i$-го автомобиля в модели IDM (\ref{eq:idm_acceleration}) можно представить в общем виде:
\begin{equation}
\label{eq:general_acceleration_f}
\frac{dv_i}{dt} = F(v_i, s_i, \Delta v_i),
\end{equation}
где функция ускорения $F$ для IDM имеет вид:
\begin{equation}
\label{eq:F_idm_definition}
F(v, s, \Delta v) = a \left[1 - \left(\frac{v}{v_0}\right)^\delta - \left( \frac{s^*(v, \Delta v)}{s} \right)^2 \right],
\end{equation}
и желаемая динамическая дистанция $s^*(v, \Delta v)$ определена как:
\begin{equation}
\label{eq:s_star_reminder}
s^*(v, \Delta v) = s_0 + T v + \frac{v \Delta v}{2 \sqrt{ab}}.
\end{equation}
Напомним, что $s_i = x_{i-1} - x_i - L$ (чистый зазор) и $\Delta v_i = v_i - v_{i-1}$ (относительная скорость, положительная, если $i$-й автомобиль быстрее лидера $i-1$).

\subsection{Малые возмущения относительно состояния равновесия}
\label{subsec:small_perturbations}

Предположим, что система находится в равновесном состоянии, характеризуемом скоростью $v_e$ и чистым зазором $s_e$. Введем малые возмущения относительно этого состояния:
\begin{align}
v_i(t) &= v_e + \delta v_i(t) \label{eq:pert_v} \\
x_i(t) &= x_{i,e}(t) + \delta x_i(t) \label{eq:pert_x} \\
s_i(t) &= s_e + \delta s_i(t) \label{eq:pert_s}
\end{align}
где $x_{i,e}(t) = x_{0,e} + i(s_e+L) + v_e t$ – равновесная координата $i$-го автомобиля (если лидер $0$ начал движение из $x_{0,e}$ в $t=0$).
Тогда возмущение зазора $\delta s_i(t)$ связано с возмущениями координат:
\[ s_i(t) = (x_{i-1,e}(t) + \delta x_{i-1}(t)) - (x_{i,e}(t) + \delta x_i(t)) - L \]
\[ s_e + \delta s_i(t) = (x_{i-1,e}(t) - x_{i,e}(t) - L) + (\delta x_{i-1}(t) - \delta x_i(t)) \]
Поскольку $s_e = x_{i-1,e}(t) - x_{i,e}(t) - L$ (если автомобили пронумерованы так, что $i-1$ впереди $i$), то:
\begin{equation}
\label{eq:delta_s_relation}
\delta s_i(t) = \delta x_{i-1}(t) - \delta x_i(t).
\end{equation}
Взяв производную по времени от (\ref{eq:delta_s_relation}), получаем связь между возмущением скорости изменения зазора и возмущениями скоростей:
\begin{equation}
\label{eq:delta_s_dot_relation}
\frac{d(\delta s_i)}{dt} = \delta v_{i-1}(t) - \delta v_i(t).
\end{equation}
Возмущение относительной скорости $\Delta v_i = v_i - v_{i-1}$ также выражается через возмущения скоростей:
\begin{equation}
\label{eq:delta_delta_v_relation}
\delta (\Delta v_i(t)) = (v_e + \delta v_i(t)) - (v_e + \delta v_{i-1}(t)) = \delta v_i(t) - \delta v_{i-1}(t).
\end{equation}
Линеаризуем уравнение ускорения (\ref{eq:general_acceleration_f}), раскладывая функцию $F$ в ряд Тейлора в окрестности точки равновесия $(v_e, s_e, \Delta v_e=0)$ и ограничиваясь членами первого порядка малости:
\begin{multline}
\label{eq:linearized_acceleration_general}
\frac{d(v_e + \delta v_i)}{dt} \approx F(v_e, s_e, 0) + \left.\frac{\partial F}{\partial v}\right|_e \delta v_i(t) \\
+ \left.\frac{\partial F}{\partial s}\right|_e \delta s_i(t) + \left.\frac{\partial F}{\partial (\Delta v)}\right|_e \delta (\Delta v_i(t)).
\end{multline}
Поскольку $F(v_e, s_e, 0) = 0$ (условие равновесия) и $dv_e/dt = 0$, получаем линеаризованное уравнение для возмущения скорости $\delta v_i(t)$:
\begin{equation}
\label{eq:linearized_dv_dt}
\frac{d(\delta v_i)}{dt} = \left.\frac{\partial F}{\partial v}\right|_e \delta v_i(t) + \left.\frac{\partial F}{\partial s}\right|_e \delta s_i(t) + \left.\frac{\partial F}{\partial (\Delta v)}\right|_e (\delta v_i(t) - \delta v_{i-1}(t)).
\end{equation}
Это уравнение вместе с (\ref{eq:delta_s_dot_relation}) образует систему линеаризованных уравнений для возмущений $\delta v_i(t)$ и $\delta s_i(t)$.

\subsection{Частные производные функции ускорения IDM}
\label{subsec:partial_derivatives_idm}

Для дальнейшего анализа необходимо вычислить частные производные функции ускорения $F(v,s,\Delta v)$ по ее аргументам $v, s, \Delta v$ в точке равновесия $(v_e, s_e, 0)$.
Обозначим для краткости:
\[ \varphi(v) = \left(\frac{v}{v_0}\right)^{\delta}, \qquad \psi(v,s,\Delta v) = \left(\frac{s^*(v, \Delta v)}{s}\right)^{2}. \]
Тогда $F = a(1-\varphi-\psi)$.

\paragraph{1. Производная по текущей скорости $v$ (собственной скорости автомобиля).}
Обозначим эту производную как $A_F = \left.\frac{\partial F}{\partial v}\right|_e$.
\[ \frac{\partial F}{\partial v} = -a \left( \frac{\partial \varphi}{\partial v} + \frac{\partial \psi}{\partial v} \right). \]
\[ \frac{\partial \varphi}{\partial v} = \frac{\delta}{v_0^\delta} v^{\delta-1} = \frac{\delta}{v} \left(\frac{v}{v_0}\right)^{\delta} = \frac{\delta}{v} \varphi(v). \]
Для производной $\partial \psi / \partial v$:
\[ \frac{\partial \psi}{\partial v} = 2 \frac{s^*(v, \Delta v)}{s^2} \frac{\partial s^*(v, \Delta v)}{\partial v}. \]
В состоянии равновесия $\Delta v = 0$, поэтому $s^*(v_e, 0) = s_0 + T v_e$.
Производная $s^*$ по $v$ при $\Delta v = 0$:
\[ \left.\frac{\partial s^*(v, \Delta v)}{\partial v}\right|_{\Delta v=0} = \frac{\partial}{\partial v} \left(s_0 + T v + \frac{v \Delta v}{2 \sqrt{ab}}\right) \Bigg|_{\Delta v=0} = T + \left.\frac{\Delta v}{2 \sqrt{ab}}\right|_{\Delta v=0} = T. \]
Тогда в точке равновесия $(v_e, s_e, 0)$:
\[ \left.\frac{\partial \psi}{\partial v}\right|_e = 2 \frac{s_0 + T v_e}{s_e^2} \cdot T. \]
Следовательно, производная $A_F$:
\begin{equation}
\label{eq:df_dv_A}
A_F = \left.\frac{\partial F}{\partial v}\right|_e = -a \left[ \frac{\delta}{v_e} \left(\frac{v_e}{v_0}\right)^{\delta} + 2T \frac{s_0 + T v_e}{s_e^2} \right].
\end{equation}
Физический смысл $A_F$: этот коэффициент (обычно отрицательный) показывает, насколько сильно водитель реагирует (изменяет ускорение) на отклонение его *собственной* скорости от равновесной $v_e$. Если $v_i > v_e$, то $\delta v_i > 0$, и если $A_F < 0$, то $d(\delta v_i)/dt$ будет содержать отрицательный член $A_F \delta v_i$, способствующий возвращению скорости к $v_e$.

\paragraph{2. Производная по дистанции $s$ (чистому зазору).}
Обозначим эту производную как $C_F = \left.\frac{\partial F}{\partial s}\right|_e$.
\[ \frac{\partial F}{\partial s} = -a \frac{\partial \psi}{\partial s}. \]
Так как $s^*(v, \Delta v)$ не зависит от $s$:
\[ \frac{\partial \psi}{\partial s} = (s^*)^2 \frac{\partial}{\partial s} (s^{-2}) = (s^*)^2 (-2 s^{-3}) = -2 \frac{(s^*)^2}{s^3}. \]
В точке равновесия $(v_e, s_e, 0)$, где $s^*(v_e,0) = s_0+Tv_e$:
\begin{equation}
\label{eq:df_ds_C}
C_F = \left.\frac{\partial F}{\partial s}\right|_e = -a \left(-2 \frac{(s_0+Tv_e)^2}{s_e^3}\right) = 2a \frac{(s_0+Tv_e)^2}{s_e^3}.
\end{equation}
Физический смысл $C_F$: этот коэффициент (всегда положительный, если $a>0$) показывает, насколько сильно водитель реагирует на отклонение зазора $s_i$ от равновесного $s_e$. Если зазор $s_i$ увеличивается ($\delta s_i > 0$), то $C_F \delta s_i > 0$, что приводит к положительному вкладу в ускорение для сокращения зазора. Если зазор уменьшается, вклад отрицателен (торможение).

\paragraph{3. Производная по относительной скорости $\Delta v = v - v_{lead}$.}
Обозначим эту производную как $B_F = \left.\frac{\partial F}{\partial (\Delta v)}\right|_e$.
\[ \frac{\partial F}{\partial (\Delta v)} = -a \frac{\partial \psi}{\partial (\Delta v)}. \]
\[ \frac{\partial \psi}{\partial (\Delta v)} = 2 \frac{s^*(v, \Delta v)}{s^2} \frac{\partial s^*(v, \Delta v)}{\partial (\Delta v)}. \]
Из (\ref{eq:s_star_reminder}):
\[ \frac{\partial s^*(v, \Delta v)}{\partial (\Delta v)} = \frac{v}{2 \sqrt{ab}}. \]
В точке равновесия $(v_e, s_e, 0)$, где $s^*(v_e,0) = s_0+Tv_e$:
\[ \left.\frac{\partial \psi}{\partial (\Delta v)}\right|_e = 2 \frac{s_0+Tv_e}{s_e^2} \frac{v_e}{2 \sqrt{ab}} = \frac{(s_0+Tv_e)v_e}{s_e^2 \sqrt{ab}}. \]
Следовательно, производная $B_F$:
\begin{equation}
\label{eq:df_ddv_B}
B_F = \left.\frac{\partial F}{\partial (\Delta v)}\right|_e = -a \frac{(s_0+Tv_e)v_e}{s_e^2 \sqrt{ab}}.
\end{equation}
Физический смысл $B_F$: этот коэффициент (обычно отрицательный) показывает, насколько сильно водитель реагирует на появление относительной скорости $\Delta v_i$. Если $\Delta v_i = v_i - v_{i-1} > 0$ (т.е. $i$-й автомобиль догоняет лидера), то $\delta(\Delta v_i) > 0$. Так как $B_F < 0$, член $B_F \delta(\Delta v_i)$ будет отрицательным, что означает торможение. Это соответствует "интеллектуальному" поведению: при сокращении дистанции из-за большей скорости водитель начинает тормозить.

В работах Трейбера и др. коэффициенты могут обозначаться иначе или относительная скорость может определяться как $\Delta v = v_{lead} - v_{follower}$. Важно следить за определениями. Приведенные здесь производные $A_F, B_F, C_F$ соответствуют определению $\Delta v_i = v_i - v_{i-1}$ и стандартной форме $s^*$ (\ref{eq:s_star_reminder}).
Заметим, что $A_F < 0$, $C_F > 0$, $B_F < 0$ для типичных параметров модели.

\subsection{Линеаризованные уравнения движения для возмущений}
\label{subsec:linearized_equations_perturbations}

Подставляя вычисленные частные производные $A_F, B_F, C_F$ в уравнение (\ref{eq:linearized_dv_dt}), получаем уравнение для возмущения скорости $\delta v_i(t)$:
\begin{equation}
\label{eq:linear_dv_dt_final}
\frac{d(\delta v_i)}{dt} = A_F \cdot \delta v_i(t) + C_F \cdot \delta s_i(t) + B_F \cdot (\delta v_i(t) - \delta v_{i-1}(t)).
\end{equation}
Это уравнение можно переписать, сгруппировав члены при $\delta v_i(t)$ и $\delta v_{i-1}(t)$:
\begin{equation}
\label{eq:linear_dv_dt_grouped}
\frac{d(\delta v_i)}{dt} = (A_F + B_F) \cdot \delta v_i(t) - B_F \cdot \delta v_{i-1}(t) + C_F \cdot \delta s_i(t).
\end{equation}
Напомним также уравнение для скорости изменения возмущения зазора (\ref{eq:delta_s_dot_relation}):
\begin{equation}
\label{eq:linear_ds_dt_final}
\frac{d(\delta s_i)}{dt} = \delta v_{i-1}(t) - \delta v_i(t).
\end{equation}
Система уравнений (\ref{eq:linear_dv_dt_grouped}) и (\ref{eq:linear_ds_dt_final}) описывает динамику малых возмущений в цепочке автомобилей, моделируемых с помощью IDM. Эта система является основой для анализа различных типов устойчивости.

\subsection{Волновой анализ устойчивости однородного потока}
\label{subsec:wave_stability_analysis}

Для исследования устойчивости однородного транспортного потока по отношению к малым возмущениям различной пространственной структуры используется волновой анализ. Предполагается, что возмущения распространяются вдоль цепочки автомобилей в виде волн.
Рассмотрим гармонические возмущения вида:
\begin{align}
\delta v_j(t) &= \hat{V} e^{\lambda t + i k j} \label{eq:wave_v} \\
\delta s_j(t) &= \hat{S} e^{\lambda t + i k j} \label{eq:wave_s}
\end{align}
где:
\begin{itemize}
    \item $j$ – номер автомобиля в цепочке.
    \item $\hat{V}$ и $\hat{S}$ – комплексные амплитуды возмущений скорости и зазора.
    \item $\lambda$ – комплексный показатель Ляпунова (инкремент). Его действительная часть $\text{Re}(\lambda)$ определяет скорость роста или затухания возмущений ($\text{Re}(\lambda) < 0$ – затухание, устойчивость; $\text{Re}(\lambda) > 0$ – рост, неустойчивость). Его мнимая часть $\text{Im}(\lambda)$ определяет частоту осцилляций.
    \item $k$ – волновое число, характеризующее пространственную структуру волны. $k \in [-\pi, \pi]$ (или $k \in [0, \pi]$ из-за симметрии). Длина волны $L_w = 2\pi/|k|$ (в единицах межавтомобильного расстояния). Малые $k$ соответствуют длинноволновым возмущениям, большие $k$ (близкие к $\pi$) – коротковолновым.
    \item $i = \sqrt{-1}$ – мнимая единица.
\end{itemize}
Подставляем эти анзацы в систему линеаризованных уравнений (\ref{eq:linear_dv_dt_grouped}) и (\ref{eq:linear_ds_dt_final}).
Из (\ref{eq:wave_v}) и (\ref{eq:wave_s}):
\[ \frac{d(\delta v_j)}{dt} = \lambda \hat{V} e^{\lambda t + i k j} = \lambda \delta v_j \]
\[ \frac{d(\delta s_j)}{dt} = \lambda \hat{S} e^{\lambda t + i k j} = \lambda \delta s_j \]
\[ \delta v_{j-1} = \hat{V} e^{\lambda t + i k (j-1)} = \hat{V} e^{\lambda t + i k j} e^{-ik} = \delta v_j e^{-ik} \]
\[ \delta s_{j-1} = \hat{S} e^{\lambda t + i k (j-1)} = \hat{S} e^{\lambda t + i k j} e^{-ik} = \delta s_j e^{-ik} \]
Подставляя в линеаризованные уравнения:
\begin{align*}
\lambda \delta v_j &= (A_F + B_F) \delta v_j - B_F \delta v_j e^{-ik} + C_F \delta s_j \\
\lambda \delta s_j &= \delta v_j e^{-ik} - \delta v_j
\end{align*}
Сокращая на общий множитель $e^{\lambda t + i k j}$ и заменяя $\delta v_j \to \hat{V}$, $\delta s_j \to \hat{S}$:
\begin{align}
\lambda \hat{V} &= [(A_F + B_F) - B_F e^{-ik}] \hat{V} + C_F \hat{S} \label{eq:wave_eq1_amp} \\
\lambda \hat{S} &= (e^{-ik} - 1) \hat{V} \label{eq:wave_eq2_amp}
\end{align}
Это система линейных однородных уравнений относительно амплитуд $\hat{V}$ и $\hat{S}$. Для существования нетривиального решения (т.е. $\hat{V}, \hat{S}$ не равны одновременно нулю), определитель матрицы коэффициентов должен быть равен нулю.
Запишем систему так:
\begin{align*}
(\lambda - (A_F+B_F) + B_F e^{-ik}) \hat{V} - C_F \hat{S} &= 0 \\
-(e^{-ik}-1)\hat{V} + \lambda \hat{S} &= 0
\end{align*}
Тогда определитель:
\[ (\lambda - (A_F+B_F) + B_F e^{-ik})\lambda - C_F (e^{-ik}-1) = 0 \]
\[ \lambda^2 - [(A_F+B_F) - B_F e^{-ik}] \lambda - C_F (e^{-ik}-1) = 0 \]
\begin{equation}
\label{eq:characteristic_equation_k_lambda}
\lambda^2 - [A_F + B_F(1 - e^{-ik})] \lambda + C_F (1 - e^{-ik}) = 0.
\end{equation}
Это характеристическое уравнение для $\lambda$ как функции волнового числа $k$ и параметров модели ($A_F, B_F, C_F$). Корни этого квадратного уравнения $\lambda_{1,2}(k)$ определяют устойчивость потока для возмущений с волновым числом $k$. Поток считается устойчивым, если $\text{Re}(\lambda(k)) < 0$ для всех $k \in (0, \pi]$. (Случай $k=0$ соответствует однородному смещению всей цепочки и обычно не рассматривается в контексте внутренней устойчивости).

\subsubsection{Учет времени реакции водителя}
В некоторых анализах устойчивости вводится явное время реакции водителя $\tau_r$. Это означает, что водитель реагирует на ситуацию, которая была $\tau_r$ секунд назад. В линеаризованных уравнениях это приводит к появлению запаздывающих аргументов у возмущений.
Характеристическое уравнение в этом случае может принимать более сложную форму, часто трансцендентную. В `chapter1.tex` и соответствующей литературе (например, \cite{treiber2013traffic}) для анализа с учетом времени реакции $\tau_r$ приводится уравнение вида (адаптируя обозначения к нашим $A_F, B_F, C_F$ и консистентным знакам):
\begin{equation}
\label{eq:char_eq_tau_r_final_consistent}
\lambda^2 - e^{-\lambda \tau_r} \left[ (A_F + B_F(1 - e^{-ik}))\lambda + C_F(e^{ik}-1) \right] = 0.
\end{equation}
Это уравнение является трансцендентным относительно $\lambda$ и его анализ сложнее, чем для полиномиального уравнения. Обычно ищутся условия, при которых $\text{Re}(\lambda)$ пересекает ноль (граница устойчивости).

\subsubsection{Анализ на границе устойчивости (для уравнения с $\tau_r$)}
На границе устойчивости $\text{Re}(\lambda) = 0$, поэтому $\lambda = i\omega$, где $\omega \in \mathbb{R}$ – частота нейтральных осцилляций.
Подставляя $\lambda = i\omega$ в (\ref{eq:char_eq_tau_r_final_consistent}):
\[ (i\omega)^2 - e^{-i\omega \tau_r} \left[ (A_F + B_F(1 - e^{-ik}))(i\omega) + C_F(e^{ik}-1) \right] = 0 \]
\begin{multline*}
-\omega^2 = (\cos(\omega \tau_r) - i\sin(\omega \tau_r)) \\
\left[ i\omega (A_F + B_F(1 - \cos k + i \sin k)) + C_F(\cos k + i \sin k - 1) \right].
\end{multline*}
Это уравнение распадается на два действительных уравнения (для вещественной и мнимой частей), которые связывают $\omega$, $k$, $\tau_r$ и параметры $A_F, B_F, C_F$. Решение этой системы позволяет найти критическое время реакции $\tau_{cr}(k)$, при котором поток теряет устойчивость для возмущений с волновым числом $k$.

Наиболее критичной (нестабильной) часто является коротковолновая мода $k=\pi$. Для $k=\pi$, $e^{ik}=-1$ и $e^{-ik}=-1$.
Тогда $1-e^{-ik} = 1 - (-1) = 2$. И $e^{ik}-1 = -1-1 = -2$.
Уравнение (\ref{eq:char_eq_tau_r_final_consistent}) для $k=\pi$ становится:
\begin{equation}
\label{eq:char_eq_tau_r_k_pi}
\lambda^2 - e^{-\lambda \tau_r} \left[ (A_F + 2B_F)\lambda - 2C_F \right] = 0.
\end{equation}
Обозначим $D_F = A_F + 2B_F$.
\begin{equation}
\label{eq:char_eq_tau_r_k_pi_D}
\lambda^2 - e^{-\lambda \tau_r} [D_F \lambda - 2C_F] = 0.
\end{equation}
На границе устойчивости $\lambda = i\omega$:
\[ -\omega^2 = (\cos(\omega \tau_r) - i\sin(\omega \tau_r)) [i\omega D_F - 2C_F]. \]
Приравнивая вещественные и мнимые части:
\begin{align}
-\omega^2 &= -2C_F \cos(\omega \tau_r) + \omega D_F \sin(\omega \tau_r) \label{eq:real_part_k_pi} \\
0 &= \omega D_F \cos(\omega \tau_r) + 2C_F \sin(\omega \tau_r) \label{eq:imag_part_k_pi}
\end{align}
Из этой системы (как показано в `chapter1.tex` и аналогичных источниках) можно получить уравнение для $\omega^2$:
\[ \omega^4 - D_F^2 \omega^2 - 4C_F^2 = 0. \]
Решая это квадратное уравнение относительно $\omega^2$ (и выбирая физически значимый положительный корень, так как $\omega^2 > 0$):
\begin{equation}
\label{eq:omega_sq_solution}
\omega^2 = \frac{1}{2} \left( D_F^2 + \sqrt{D_F^4 + 16C_F^2} \right).
\end{equation}
Зная $\omega^2$ (и, следовательно, $\omega = \sqrt{\omega^2}$), можно найти критическое значение времени реакции $\tau_{cr}$ из системы (\ref{eq:real_part_k_pi})-(\ref{eq:imag_part_k_pi}). Например, из (\ref{eq:imag_part_k_pi}), если $\omega \neq 0$ и $2C_F \neq 0$:
$\tan(\omega \tau_r) = -\frac{\omega D_F}{2C_F}$. Отсюда:
\begin{equation}
\label{eq:tau_cr_final}
\tau_{cr} = \frac{1}{\omega} \arctan\left(-\frac{\omega D_F}{2C_F}\right) + \frac{n\pi}{\omega}, \quad n \in \mathbb{Z}
\end{equation}
(выбирается наименьшее положительное $\tau_{cr}$). Также можно использовать выражение для $\cos(\omega \tau_r)$ из (\ref{eq:real_part_k_pi}) и (\ref{eq:imag_part_k_pi}):
$\cos(\omega \tau_r) = \frac{2C_F \omega^2}{4C_F^2 + \omega^2 D_F^2}$.
Тогда:
\[ \tau_{cr} = \frac{1}{\omega} \arccos\left(\frac{2C_F \omega^2}{4C_F^2 + \omega^2 D_F^2}\right). \]

Условия устойчивости для системы с запаздыванием $\tau_r$ (для моды $k=\pi$):
Система будет устойчива, если $\tau_r < \tau_{cr}$. Дополнительно, для устойчивости часто требуются условия $D_F = A_F + 2B_F < 0$ и $C_F > 0$.
$C_F > 0$ обычно выполняется для IDM (см. (\ref{eq:df_ds_C})).
$A_F < 0$ и $B_F < 0$, поэтому $D_F = A_F + 2B_F$ также обычно отрицателен.
Следовательно, основным фактором, приводящим к неустойчивости, часто является именно запаздывание $\tau_r$.
Приближенная оценка для критического времени реакции, дающая консервативную границу устойчивости: $\tau_r \lesssim \frac{|D_F|}{2C_F}$ (поскольку $D_F<0$).

Этот анализ показывает, что введение времени реакции водителя $\tau_r$ существенно влияет на устойчивость потока. Даже если параметры $A_F, B_F, C_F$ таковы, что система устойчива без запаздывания ($D_F<0, C_F>0$), достаточно большое значение $\tau_r$ может привести к возникновению колебаний типа "stop-and-go", особенно для коротковолновых возмущений ($k=\pi$).

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.7\linewidth]{stability_regions.png} % Изображение закомментировано
% 	\caption{Примерная диаграмма областей устойчивости в зависимости от параметров модели (например, $T$ и $v_0$) или времени реакции $\tau_r$.}
% 	\label{fig:stability_regions_tau}
% \end{figure}

\subsection{Локальная устойчивость (устойчивость взвода)}
\label{subsec:platoon_stability}

Локальная устойчивость, также известная как устойчивость взвода (platoon stability), относится к способности системы (например, пары автомобилей лидер-последователь или небольшого взвода) возвращаться к состоянию равновесия после малого возмущения, при условии,
что самый первый (головной) автомобиль взвода после начального возмущения продолжает двигаться с постоянной равновесной скоростью $v_e$. Этот тип анализа фокусируется на реакции отдельного автомобиля на поведение своего непосредственного лидера и не рассматривает распространение волны возмущений по бесконечной цепочке автомобилей.

Рассмотрим $i$-й автомобиль, следующий за $(i-1)$-м лидером, который движется с постоянной скоростью $v_{i-1}(t) = v_e$ (т.е. $\delta v_{i-1}(t) = 0$).
Тогда линеаризованное уравнение для $i$-го автомобиля (\ref{eq:linear_dv_dt_grouped}) упрощается:
\begin{equation}
\label{eq:local_dv_dt}
\frac{d(\delta v_i)}{dt} = (A_F + B_F) \cdot \delta v_i(t) + C_F \cdot \delta s_i(t).
\end{equation}
Уравнение для зазора (\ref{eq:linear_ds_dt_final}) при $\delta v_{i-1}(t)=0$:
\begin{equation}
\label{eq:local_ds_dt}
\frac{d(\delta s_i)}{dt} = - \delta v_i(t).
\end{equation}
Это система двух линейных обыкновенных дифференциальных уравнений для $\delta v_i(t)$ и $\delta s_i(t)$.
Ищем решение в виде $\delta v_i(t) = \hat{V} e^{\lambda_{loc} t}$ и $\delta s_i(t) = \hat{S} e^{\lambda_{loc} t}$.
Подстановка в систему дает характеристическое уравнение:
\[ \lambda_{loc}^2 - (A_F + B_F) \lambda_{loc} + C_F = 0. \]
Локальная устойчивость (устойчивость взвода) обеспечивается, если действительные части обоих корней $\lambda_{loc}$ этого квадратного уравнения отрицательны ($\text{Re}(\lambda_{loc}) < 0$). Согласно критерию Рауса-Гурвица, для квадратного уравнения $\lambda^2 + K_1 \lambda + K_0 = 0$ это эквивалентно тому, что все коэффициенты уравнения положительны: $K_1 > 0$ и $K_0 > 0$.
В нашем случае:
\begin{enumerate}
    \item $K_0 = C_F > 0$. Как мы видели (\ref{eq:df_ds_C}), $C_F = 2a (s_0+Tv_e)^2/s_e^3$, что положительно для $a>0$. Это условие отражает рациональное поведение водителя: увеличение зазора приводит к ускорению, уменьшение – к торможению.
    \item $K_1 = -(A_F + B_F) > 0$.
    Напомним, $A_F = -a [ (\delta/v_e)(v_e/v_0)^\delta + 2T(s_0+Tv_e)/s_e^2 ] < 0$.
    И $B_F = -a (s_0+Tv_e)v_e/(s_e^2 \sqrt{ab}) < 0$.
    Следовательно, $A_F + B_F$ является суммой двух отрицательных чисел, т.е. $A_F+B_F < 0$.
    Тогда $-(A_F+B_F) > 0$.
\end{enumerate}
Таким образом, для модели IDM с типичными параметрами оба условия локальной устойчивости обычно выполняются. Это означает, что если лидер взвода поддерживает постоянную скорость, то флуктуации скорости и зазора у следующего за ним автомобиля будут затухать со временем. Модель IDM, как правило, является локально устойчивой.
Однако локальная устойчивость не гарантирует устойчивость всей бесконечной цепочки автомобилей.

\subsection{Струнная устойчивость (устойчивость потока)}
\label{subsec:string_stability}

Струнная устойчивость (string stability, или асимптотическая устойчивость) характеризует, как возмущения распространяются вверх по течению в *бесконечной* или очень длинной цепочке автомобилей. Поток считается струнно устойчивым, если амплитуда возмущения не нарастает (а в идеале – затухает) при передаче от одного автомобиля к другому. Если амплитуда нарастает, поток струнно неустойчив.
Струнная неустойчивость является основной причиной возникновения волн "stop-and-go" (фантомных заторов) в плотном транспортном потоке. Даже если каждый водитель локально стабильно реагирует на своего лидера, совокупный эффект от задержек реакции и чувствительности к изменениям может привести к усилению возмущений по мере их распространения.

Критерий струнной устойчивости часто формулируется как требование, чтобы модуль передаточной функции от возмущения скорости $(j-1)$-го автомобиля к возмущению скорости $j$-го автомобиля был меньше или равен единице для всех частот:
\[ \left| \frac{\delta \tilde{v}_j(\omega)}{\delta \tilde{v}_{j-1}(\omega)} \right| \le 1 \quad \forall \omega, \]
где $\delta \tilde{v}(\omega)$ – преобразование Фурье от $\delta v(t)$.

Альтернативно, струнная устойчивость анализируется через максимальную действительную часть инкремента $\lambda(k)$ из волнового анализа (\ref{eq:characteristic_equation_k_lambda}) или его аналога с учетом времени реакции (\ref{eq:char_eq_tau_r_final_consistent}). Поток струнно устойчив, если $\max_k (\text{Re}(\lambda(k))) < 0$ для всех $k \in (0, \pi]$. Если $\max_k (\text{Re}(\lambda(k))) > 0$ для какого-либо $k \neq 0$, то поток струнно неустойчив.

\subsubsection{Критерий струнной устойчивости для IDM (без явного $\tau_r$)}
Рассмотрим характеристическое уравнение (\ref{eq:characteristic_equation_k_lambda}) без явного учета $\tau_r$:
\[ \lambda^2 - [A_F + B_F(1 - e^{-ik})] \lambda + C_F (1 - e^{-ik}) = 0. \]
Для длинноволновых возмущений ($k \to 0$), $e^{-ik} \approx 1 - ik$.
Тогда $1 - e^{-ik} \approx ik$.
Коэффициент при $\lambda$: $-(A_F + B_F ik)$.
Свободный член: $C_F ik$.
В литературе (например, \cite{treiber2013traffic}) для IDM (без явного $\tau_r$) условие струнной устойчивости для длинноволновых возмущений ($k \to 0$) часто записывается в терминах коэффициента $K = (A_F/2)^2 + B_F(A_F/2) - C_F/2$. (Определение $K$ может варьироваться).
Более общий критерий, иногда используемый (например, в `THEORETICAL_BACKGROUND.md`, раздел 6.1), для модели без явного $\tau_r$:
Поток устойчив, если $A_F < 0$ и $K_s = A_F^2/2 - B_F A_F - C_F > 0$.
Здесь $A_F^2/2 > 0$. $B_F A_F > 0$ (произведение двух отрицательных), поэтому $-B_F A_F < 0$. $-C_F < 0$.
Знак $K_s$ не очевиден и зависит от величин $A_F, B_F, C_F$. Если $K_s < 0$, это предсказывает неустойчивость. Этот критерий $K_s > 0$ является достаточно строгим.

Когда учитывается время реакции $\tau_r$, как в уравнении (\ref{eq:char_eq_tau_r_final_consistent}), струнная неустойчивость возникает, если $\text{Re}(\lambda(k,\tau_r)) > 0$ для некоторого $k$. Это обычно происходит, когда $\tau_r$ превышает некоторое критическое значение $\tau_{cr}(k)$.

\subsubsection{Интерпретация струнной неустойчивости}
Струнная неустойчивость означает, что небольшое случайное торможение одного автомобиля может вызвать более сильное торможение у следующего за ним автомобиля, еще более сильное у следующего, и так далее. В результате амплитуда волны торможения нарастает по мере ее распространения против потока, что приводит к резкому снижению скорости и, возможно, полной остановке автомобилей далеко позади первоначального возмущения. Это и есть механизм образования фантомных заторов.

Ключевыми факторами, влияющими на струнную устойчивость, являются:
\begin{itemize}
    \item \textbf{Время реакции водителя ($\tau_r$)}: Чем больше время реакции, тем выше вероятность неустойчивости.
    \item \textbf{Чувствительность водителя}: Слишком сильная или слабая реакция на изменения зазора или скоростей.
    \item \textbf{Плотность потока}: Струнная неустойчивость обычно проявляется в плотных потоках.
\end{itemize}
Модель IDM, особенно с учетом времени реакции, способна воспроизводить явление струнной неустойчивости.

\begin{figure}[h!]
	\centering
	% \includegraphics[width=0.9\linewidth]{string_instability.png} % Изображение закомментировано
	\caption{Иллюстрация струнной неустойчивости: нарастание амплитуды возмущения скорости при распространении вверх по потоку.}
	\label{fig:string_instability_waves}
\end{figure}

\subsection{Графическое представление результатов анализа устойчивости}
\label{subsec:graphical_stability_analysis}

Результаты анализа линейной устойчивости, в частности зависимости инкремента возмущений $\lambda(k)$ от волнового числа $k$, часто представляются графически для наглядной интерпретации.

\subsubsection{Зависимость инкремента возмущений от волнового числа}
\label{subsubsec:lambda_vs_k}

Ключевым графиком для анализа устойчивости является зависимость действительной части инкремента возмущений $\text{Re}(\lambda)$ от волнового числа $k$. Напомним, что поток считается неустойчивым по отношению к возмущениям с волновым числом $k$, если $\text{Re}(\lambda(k)) > 0$.

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.8\linewidth]{conceptual_Re_lambda_vs_k.png} % Замените conceptual_Re_lambda_vs_k.png на имя реального файла
% 	\caption{Пример зависимости действительной части инкремента возмущений $\text{Re}(\lambda)$ от волнового числа $k$. Сценарий 1 (стабильный поток): кривая полностью лежит ниже нуля (нет колебаний, $\text{Re}(\lambda(k)) < 0$ для всех $k$). Сценарий 2 (нестабильный поток): кривая имеет положительные значения для некоторых $k$ (возникают колебания), часто для коротковолновых возмущений ($k \approx \pi$) при увеличении, например, времени реакции $\tau_r$.}
% 	\label{fig:re_lambda_vs_k}
% \end{figure}

На Рис. \ref{fig:re_lambda_vs_k} (концептуально) показан типичный вид такой зависимости. Можно выделить несколько характерных случаев:
\begin{itemize}
    \item \textbf{Полностью устойчивый поток (нет спонтанных колебаний)}: $\text{Re}(\lambda(k)) < 0$ для всех $k \in (0, \pi]$. В этом случае любые малые возмущения затухают, и поток остается ламинарным.
    \item \textbf{Неустойчивость (возникновение колебаний)}: $\text{Re}(\lambda(k)) > 0$ для некоторого диапазона $k$. Это приводит к росту возмущений и формированию колебаний (волн) в потоке.
    \begin{itemize}
        \item \textbf{Неустойчивость коротковолновых возмущений}: $\text{Re}(\lambda(k)) > 0$ для $k$, близких к $\pi$. Это наиболее распространенный тип неустойчивости, ведущий к "stop-and-go" волнам.
        \item \textbf{Неустойчивость длинноволновых возмущений}: $\text{Re}(\lambda(k)) > 0$ для малых $k$. Этот тип неустойчивости связан с формированием крупномасштабных волн плотности.
    \end{itemize}
\end{itemize}
Параметры модели, особенно время реакции водителя $\tau_r$, максимальное ускорение $a$, комфортное торможение $b$, и параметры желаемой дистанции $s_0, T$, существенно влияют на форму кривой $\text{Re}(\lambda(k))$ и, следовательно, на склонность потока к образованию колебаний. Увеличение времени реакции $\tau_r$, как правило, расширяет диапазон неустойчивых волновых чисел и увеличивает максимальное значение $\text{Re}(\lambda)$. Скрипт `eidm_stability_analysis.py` позволяет вычислять подобные зависимости.

\subsubsection{Диаграммы устойчивости в пространстве параметров}
\label{subsubsec:stability_diagrams_params}

Другим наглядным способом представления результатов анализа устойчивости являются диаграммы фазовой плоскости или диаграммы устойчивости в пространстве параметров модели. Эти диаграммы показывают области (регионы) в пространстве двух или более параметров, где транспортный поток является устойчивым (колебания не возникают самопроизвольно) или неустойчивым (возникают колебания).

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.7\linewidth]{conceptual_stability_diagram_T_v0.png} % Замените conceptual_stability_diagram_T_v0.png на имя реального файла
% 	\caption{Пример концептуальной диаграммы устойчивости. Область A (например, малые $T$ и $v_0$) соответствует стабильному потоку без колебаний. Область B (например, большие $T$ и $v_0$) соответствует параметрам, при которых поток становится неустойчивым и возникают колебания. Граница между областями показывает критические значения параметров.}
% 	\label{fig:stability_diagram_params}
% \end{figure}

На Рис. \ref{fig:stability_diagram_params} (концептуально) изображена такая диаграмма. Она четко разделяет пространство параметров на зоны, где ожидается ламинарное течение, и зоны, где вероятно развитие волн "stop-and-go". Анализ таких диаграмм помогает понять, какие комбинации параметров приводят к нестабильному поведению и как изменение стиля вождения или дорожных условий может перевести поток из одного режима в другой. Скрипт `eidm_stability_analysis.py` содержит функции для построения графиков, показывающих, как критерии устойчивости меняются при варьировании одного из параметров, что помогает очертить эти области стабильности и нестабильности.

\section{Следствия анализа устойчивости и транспортные явления}
\label{sec:implications_phenomena}

Анализ устойчивости транспортного потока, описываемого моделями следования типа IDM, имеет важные практические следствия для понимания и предсказания различных транспортных явлений.

\subsection{Возникновение заторов и волн "Stop-and-Go"}
\label{subsec:congestion_stop_go}

Струнная неустойчивость является основной причиной самопроизвольного возникновения заторов на автомагистралях, известных как фантомные заторы или волны "stop-and-go". Эти явления наблюдаются даже на участках дорог без видимых узких мест.
Когда транспортный поток находится в состоянии, близком к границе струнной устойчивости, любое малое возмущение может начать усиливаться при распространении против потока. Это приводит к формированию волны уплотнения, где скорость автомобилей резко падает, а плотность растет. За этой волной уплотнения часто следует волна разрежения. Чередование таких волн и создает характерную картину движения "stop-and-go".
Скорость распространения этих кинематических волн обычно отрицательна (т.е. они движутся против направления движения транспортных средств) и составляет порядка 15-20 км/ч.

Визуально эти явления хорошо видны на пространственно-временных диаграммах скорости (Рис. \ref{fig:spacetime_heatmap}). На таких диаграммах ось времени обычно горизонтальна, а ось пространства (координата вдоль дороги) – вертикальна. Скорость кодируется цветом. Участки стабильного потока без колебаний будут отображаться областями с относительно однородным цветом, соответствующим высокой или средней скорости. Напротив, возникновение волн "stop-and-go" (колебаний) проявляется в виде характерных диагональных полос с чередованием цветов (оттенков, соответствующих низкой и затем снова высокой скорости), распространяющихся назад (против направления движения основного потока).

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.9\linewidth]{spacetime_heatmap_fcd_rt_annotated.png} % Используется spacetime_heatmap_fcd_rt_annotated.png
% 	\caption{Пример пространственно-временной тепловой карты скорости. Области равномерного цвета (например, в левой части графика, если поток изначально стабилен) соответствуют движению без значительных колебаний. Диагональные полосы с резким изменением цвета (например, в правой части) демонстрируют развитие и распространение волн "stop-and-go" (колебаний скорости).}
% 	\label{fig:spacetime_heatmap}
% \end{figure}

На микроуровне поведение отдельных автомобилей в условиях "stop-and-go" характеризуется периодическими циклами ускорения и торможения, что отражается на графиках их скорости в зависимости от времени (Рис. \ref{fig:velocity_time_oscillations}) или траекторий $S(t)$ (Рис. \ref{fig:distance_time_oscillations}). Если бы поток был стабилен, линии скорости были бы близки к горизонтальным (постоянная скорость), а траектории $S(t)$ имели бы почти постоянный наклон.

\begin{figure}[h!]
	\centering
	% Пример: \includegraphics[width=0.45\linewidth]{velocity_time_stable.png}
	% Пример: \includegraphics[width=0.45\linewidth]{velocity_time_unstable.png}
	% Замените на реальные имена файлов или один файл, показывающий оба сценария
	% \includegraphics[width=0.8\linewidth]{v(t)1.png} % Используется velocity_time_every_10th.png - ЗАМЕНИТЕ ЭТО
	\caption{Скорость от времени $V(t)$ для нескольких выбранных автомобилей. В сценарии стабильного потока линии скорости близки к горизонтальным, что соответствует равномерному движению. В сценарии нестабильного потока (режим "stop-and-go") наблюдаются выраженные осцилляции скорости, указывающие на периодические ускорения и торможения.}
	\label{fig:velocity_time_oscillations}
\end{figure}

\begin{figure}[h!]
	\centering
	% Пример: \includegraphics[width=0.45\linewidth]{distance_time_stable.png}
	% Пример: \includegraphics[width=0.45\linewidth]{distance_time_unstable.png}
	% Замените на реальные имена файлов или один файл, показывающий оба сценария
	% \includegraphics[width=0.8\linewidth]{s(t)1.png} % Используется distance_time_every_10th.png - ЗАМЕНИТЕ ЭТО
	\caption{Пройденное расстояние от времени $S(t)$ для нескольких выбранных автомобилей. В сценарии стабильного потока траектории $S(t)$ имеют почти постоянный наклон, отражая постоянную скорость. В сценарии нестабильного потока (режим "stop-and-go") наблюдаются изменения наклона кривых, включая почти горизонтальные участки (остановки) и участки с более крутым наклоном (ускорения), что является следствием колебаний скорости.}
	\label{fig:distance_time_oscillations}
\end{figure}

Аналогичные осцилляции видны и на фазовых портретах $V(x)$ (скорость от положения), где траектории автомобилей в заторе могут образовывать петли или плотные скопления в области низких скоростей (Рис. \ref{fig:velocity_position_oscillations}). В случае стабильного движения без колебаний, автомобили проходили бы один и тот же участок дороги $x$ с примерно одинаковой скоростью, и график $V(x)$ был бы более гладким. Наличие колебаний приводит к тому, что на одном и том же $x$ могут наблюдаться разные скорости в разные моменты времени, формируя характерные неровные профили или петли.

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.8\linewidth]{velocity_position_every_10th.png} % Используется velocity_position_every_10th.png
% 	\caption{Скорость от положения $V(x)$ для нескольких выбранных автомобилей. Левая часть графика (меньшие $x$, до возможного затора) может показывать более высокие и стабильные скорости (меньше колебаний). Правая часть (большие $x$, в зоне затора или при его развитии) демонстрирует значительные падения скорости и осцилляции, характерные для нестабильного потока. Сценарий без колебаний представлял бы собой более гладкие кривые на высоком уровне скорости по всей длине участка.}
% 	\label{fig:velocity_position_oscillations}
% \end{figure}


\subsection{Пропускная способность и ее снижение в условиях нестабильности}
\label{subsec:capacity_reduction}

Теоретическая пропускная способность дороги соответствует максимуму на фундаментальной диаграмме $q(\rho)$. Однако в реальных условиях поток может стать нестабильным задолго до достижения этой теоретической максимальной интенсивности. Возникновение волн "stop-and-go" (колебаний) приводит к существенному снижению средней скорости и, как следствие, к уменьшению фактической пропускной способности участка дороги. Это явление известно как "срыв потока" (capacity drop).
Анализ устойчивости помогает понять, при каких условиях поток становится предрасположенным к такому срыву.

На фундаментальной диаграмме (Рис. \ref{fig:fundamental_diagram_stability}) можно отметить области, соответствующие различным режимам течения и их устойчивости. Ветвь свободного потока (низкие плотности, высокие скорости) обычно является устойчивой, т.е. колебания здесь не возникают спонтанно. Однако часть ветви синхронизованного/плотного потока (высокие плотности, средние и низкие скорости) может быть неустойчивой. Переход из устойчивого состояния (без колебаний) в неустойчивое (с колебаниями) и обратно может приводить к гистерезисным эффектам, когда для возврата к свободному течению требуется значительно снизить плотность по сравнению с той, при которой начались колебания.

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.7\linewidth]{conceptual_fundamental_diagram_stability.png} % Замените conceptual_fundamental_diagram_stability.png на имя реального файла
% 	\caption{Концептуальная фундаментальная диаграмма ($q$ от $\rho$). Область свободного потока (слева) обычно устойчива (нет колебаний). Область плотного потока (справа) может быть частично или полностью неустойчива, что приводит к возникновению колебаний ("stop-and-go") и снижению реальной пропускной способности по сравнению с теоретическим максимумом.}
% 	\label{fig:fundamental_diagram_stability}
% \end{figure}

\subsection{Влияние гетерогенности водителей}
\label{subsec:driver_heterogeneity}

В реальном транспортном потоке водители обладают различными характеристиками. Эта гетерогенность может существенно влиять на устойчивость потока. Наличие нескольких слишком агрессивных или, наоборот, слишком медлительных водителей может служить источником возмущений.
В целом, большая вариативность в параметрах водителей может снижать общую стабильность потока.

\subsection{Спектральный анализ колебаний скорости}
\label{subsec:spectral_analysis_velocity}

Для количественной характеристики колебаний в транспортном потоке, таких как волны "stop-and-go", используется спектральный анализ, в частности, вычисление амплитудного спектра Фурье для временных рядов скорости. Этот метод позволяет выявить доминирующие частоты в колебаниях скорости.

% \begin{figure}[h!]
% 	\centering
% 	% \includegraphics[width=0.8\linewidth]{fft_mean_speed.png} % Используется fft_mean_speed.png
% 	\caption{Амплитудный спектр Фурье средней скорости потока. Сценарий 1 (стабильный поток, нет колебаний): спектр содержит в основном пик на нулевой частоте (DC-компонента, средняя скорость). Сценарий 2 (нестабильный поток, есть колебания): помимо DC-компоненты, появляются выраженные пики на ненулевых частотах, соответствующих характерным частотам волн "stop-and-go".}
% 	\label{fig:fft_mean_speed}
% \end{figure}

На Рис. \ref{fig:fft_mean_speed} показан пример такого спектра. 
Если поток стабилен и автомобили движутся с постоянной или плавно меняющейся скоростью (отсутствие выраженных колебаний), то амплитудный спектр будет сосредоточен в основном в области низких частот, с доминирующим пиком на нулевой частоте (DC-компонента), представляющей среднюю скорость. 
Напротив, при наличии периодических колебаний скорости, характерных для волн "stop-and-go", в спектре появятся один или несколько выраженных пиков на ненулевых частотах. Положение этих пиков указывает на характерные частоты (и, соответственно, периоды) колебаний. Например, пик на частоте 0.02 Гц соответствует периоду колебаний 50 секунд. Анализ таких спектров помогает объективно оценить наличие и интенсивность колебаний в потоке.

\section{Теоретические аспекты современных методов анализа и управления транспортными потоками}
\label{sec:advanced_concepts_theory}

Понимание фундаментальных свойств моделей следования и механизмов устойчивости транспортного потока открывает возможности для разработки продвинутых систем мониторинга и управления дорожным движением.

\subsection{Теоретические основы обнаружения волн в транспортном потоке}
\label{subsec:wave_detection_theory}

Возникновение и распространение волн плотности и скорости являются ключевыми индикаторами состояния транспортного потока, особенно перехода к нестабильному режиму с колебаниями. Способность обнаруживать такие волны в реальном времени или при анализе данных имеет большое значение как для оценки текущей дорожной ситуации, так и для инициации управляющих воздействий, например, со стороны систем VSL.
Теоретически, волна характеризуется изменением локальных свойств потока (скорости, плотности), которое перемещается в пространстве. Скорость распространения таких волн ($c_w$) обычно отрицательна (т.е. волна движется против направления движения транспортных средств) и является важным параметром.

Данные для обнаружения волн могут поступать от:
\begin{itemize}
    \item \textbf{Стационарных детекторов} (например, индукционных петель, микроволновых радаров), расположенных вдоль дороги. Эти детекторы измеряют локальные параметры потока, такие как интенсивность (количество автомобилей в единицу времени), скорость и занятость полосы (процент времени, в течение которого детектор "занят" автомобилем).
    \item \textbf{Floating Car Data (FCD)}, то есть данные от движущихся автомобилей (например, GPS-треки от навигаторов, такси, общественного транспорта). Эти данные предоставляют информацию о траекториях и скоростях отдельных транспортных средств.
\end{itemize}

Методы обнаружения волн включают:
\begin{enumerate}
    \item \textbf{Анализ временных рядов от одного детектора}: Резкие изменения скорости или плотности (или занятости) на одном детекторе могут сигнализировать о прохождении фронта волны. Например, значительное падение скорости ниже некоторого порога может указывать на формирование или приход затора.
    \item \textbf{Пространственно-временной анализ данных от нескольких детекторов}:
        \begin{itemize}
            \item \textbf{Взаимная корреляция (Cross-correlation)}: Этот метод часто используется для данных от двух или более последовательно расположенных стационарных детекторов. Анализируются временные ряды одного и того же параметра (например, скорости или интенсивности) от этих детекторов. Пик в функции взаимной корреляции указывает на временной сдвиг ($\Delta t_{wave}$) прохождения волны между детекторами. Зная расстояние между детекторами ($\Delta x$), можно оценить скорость распространения волны: $c_w = \Delta x / \Delta t_{wave}$. Знак $c_w$ указывает направление распространения волны.
            \item \textbf{Сравнение пороговых значений}: Алгоритмы могут отслеживать превышение или падение ниже определенных пороговых значений плотности или скорости на последовательных детекторах для идентификации распространяющейся волны.
            \item \textbf{Фильтрация сигналов}: Для повышения надежности обнаружения волн и снижения влияния шумов, исходные данные (например, временные ряды скорости) могут подвергаться предварительной обработке с использованием различных фильтров (например, скользящего среднего).
        \end{itemize}
    \item \textbf{Анализ FCD данных}:
        \begin{itemize}
            \item \textbf{Построение пространственно-временных диаграмм скорости}: Как показано на Рис. \ref{fig:spacetime_heatmap}, FCD данные позволяют напрямую визуализировать волны "stop-and-go" в виде характерных диагональных полос на $x-t$ диаграмме.
            \item \textbf{Кластеризация траекторий}: Алгоритмы кластеризации могут использоваться для группировки автомобилей, движущихся со схожими скоростными паттернами, что помогает выявлять области заторов и их границы.
        \end{itemize}
    \item \textbf{Использование моделей потока}: Некоторые подходы используют математические модели транспортного потока для предсказания и идентификации волн на основе текущих измерений.
\end{enumerate}
Обнаружение типа волны (например, ударная волна сжатия, волна разрежения) может производиться на основе анализа знака изменения скорости или плотности при прохождении волны. Эта информация критически важна для понимания динамики потока и для эффективного управления.

\subsection{Теоретические основы управления переменными скоростными ограничениями (VSL)}
\label{subsec:vsl_theory}

Управление переменными скоростными ограничениями (Variable Speed Limits, VSL) – это стратегия активного управления дорожным движением, направленная на повышение стабильности и эффективности транспортных потоков, а также на повышение безопасности. Основная идея VSL заключается в динамическом изменении максимально разрешенной скорости на участке дороги в зависимости от текущих или прогнозируемых условий движения.

\textbf{Цели VSL-контроллера:}
Главной теоретической целью VSL является предотвращение или смягчение последствий струнной неустойчивости и связанных с ней колебаний скорости (волн "stop-and-go"). Достигается это через:
\begin{itemize}
    \item \textbf{Гомогенизацию потока}: Снижение разброса скоростей между отдельными автомобилями и между полосами движения.
    \item \textbf{Предотвращение формирования ударных волн}: Заблаговременное снижение скорости перед потенциальным узким местом или зоной начинающегося затора может сгладить резкие перепады скорости.
    \item \textbf{Повышение безопасности}: Снижение вероятности аварий за счет уменьшения разницы скоростей и предупреждения водителей о неблагоприятных условиях впереди.
    \item \textbf{Оптимизация пропускной способности}: Хотя VSL часто приводит к некоторому снижению скорости в свободном потоке, предотвращение срыва потока в затор может в итоге увеличить общую среднечасовую пропускную способность и уменьшить задержки.
\end{itemize}
VSL стремится поддерживать состояние потока в области фундаментальной диаграммы (см. Рис. \ref{fig:fundamental_diagram_stability}), где колебания не развиваются спонтанно, то есть в области устойчивого свободного или синхронизированного потока докритической плотности.

\textbf{Входные данные и измерение состояния потока для VSL:}
Для эффективной работы VSL-контроллеру необходима актуальная информация о состоянии транспортного потока. Ключевыми измеряемыми или оцениваемыми параметрами являются:
\begin{itemize}
    \item \textbf{Скорость ($v$)}: 
        \begin{itemize}
            \item От стационарных детекторов: обычно вычисляется как средняя по времени скорость автомобилей, прошедших через детектор (например, среднеарифметическая или среднегармоническая скорость, последняя лучше отражает состояние плотного потока).
            \item Из FCD: средняя скорость по выборке автомобилей, находящихся на рассматриваемом участке.
        \end{itemize}
    \item \textbf{Плотность ($
ho$)}:
        \begin{itemize}
            \item От стационарных детекторов: Плотность может быть вычислена косвенно из интенсивности $q$ (количество автомобилей в единицу времени, прошедших детектор) и средней скорости $v$ по фундаментальному соотношению $\rho = q/v$. Также используется параметр "занятость полосы" (lane occupancy, $occ$), представляющий собой долю времени, в течение которого датчик зафиксировал присутствие автомобиля. Занятость линейно связана с плотностью ($
ho = occ / L_{eff}$, где $L_{eff}$ – эффективная средняя длина автомобиля плюс длина датчика) и часто используется как ее прямой суррогат.
            \item Из FCD: Плотность может оцениваться по количеству уникальных FCD-автомобилей на известной длине участка дороги.
        \end{itemize}
    \item \textbf{Интенсивность ($q$)}: Напрямую измеряется стационарными детекторами.
    \item \textbf{Данные о заторах и волнах}: Информация о наличии, местоположении и характеристиках (например, скорости распространения) волн "stop-and-go", полученная методами, описанными в разделе \ref{subsec:wave_detection_theory}, может служить важным триггером для активации или адаптации стратегий VSL.
\end{itemize}

\textbf{Принципы разработки VSL-контроллера:}
Большинство VSL-контроллеров работают на основе теории автоматического управления и используют принцип обратной связи. Основные шаги в работе такого контроллера:
\begin{enumerate}
    \item \textbf{Измерение/оценка состояния потока}: Сбор данных о $v, \rho, q$ (и, возможно, о наличии волн) на контролируемых участках дороги.
    \item \textbf{Определение целевого состояния}: Контроллер определяет целевое состояние потока, часто в виде целевой плотности $\rho_{target}$. Эта плотность выбирается ниже критической (при которой возникает неустойчивость) и может соответствовать равновесной плотности $\rho_e$. Равновесная плотность рассчитывается через равновесный чистый зазор $s_e$ и длину автомобиля $L$ по формуле $\rho_e = 1/(s_e + L)$.
    \item \textbf{Расчет ошибки}: Вычисляется отклонение текущего состояния от целевого, например, $e_\rho(t) = \rho(t) - \rho_{target}$ или $e_v(t) = v(t) - v_{target}$.
    \item \textbf{Управляющий закон}: На основе ошибки (и, возможно, ее производной и интеграла) специальный алгоритм (например, ПИ- или ПИД-регулятор, логика на основе правил, предиктивное управление) рассчитывает необходимое управляющее воздействие. Этим воздействием является новое значение рекомендуемой или обязательной максимальной скорости $v_{VSL}$.
        Например, для инкрементального ПИ-регулятора, корректирующего базовое ограничение скорости $v_{base}$:
        \[ \Delta u[k] = K_p (e[k] - e[k-1]) + K_i e[k], \]
        \[ v_{VSL}[k] = v_{base} - u[k] \quad (\text{или } v_{VSL}[k] = u[k] \text{ если } u \text{ само по себе скорость}). \]
    \item \textbf{Применение управляющего воздействия}: Рассчитанное значение $v_{VSL}$ отображается на дорожных знаках переменной информации. При этом учитываются практические ограничения: $v_{VSL}$ обычно выбирается из дискретного набора значений (например, 100, 80, 60 км/ч), изменение скорости не должно быть слишком резким (например, не более чем на 20 км/ч за один шаг или на один участок), и оно должно быть согласовано между соседними участками VSL.
\end{enumerate}

\textbf{Взаимодействие VSL с поведением водителя (модель IDM):}
В контексте микроскопических моделей, таких как IDM, отображаемое значение $v_{VSL}$ напрямую влияет на параметр $v_0$ (желаемая скорость) для водителей на данном участке. Предполагается, что большинство водителей будут стремиться не превышать $v_{VSL}$. Таким образом, VSL-система изменяет агрегированное поведение потока путем воздействия на индивидуальные решения водителей о выборе скорости.

\textbf{Линеаризация модели для управления:}
При разработке и настройке VSL-контроллеров может использоваться анализ чувствительности модели потока к изменениям $v_0$. Отклик потока (например, изменение средней скорости $v_e$ или плотности $s_e$ в равновесном состоянии) на изменение $\Delta v_0$ (вызванное $\Delta V_{VSL}$) можно аппроксимировать передаточной функцией в пространстве Лапласа:
\[ G(p) = \frac{\Delta \tilde{V}_{flow}(p)}{\Delta \tilde{V}_{VSL}(p)} = \frac{K_{gain} e^{-\tau_{delay} p}}{T_{const} p + 1}. \]
Параметры этой функции (коэффициент усиления $K_{gain}$, транспортная задержка $\tau_{delay}$, постоянная времени $T_{const}$) могут быть оценены на основе линеаризованной модели IDM или более сложных макроскопических моделей. Например, чувствительность функции ускорения IDM $F(v,s,\Delta v)$ к изменению параметра $v_0$ в состоянии равновесия $(v_e, s_e, 0)$ определяется как $f_{v_0} = (\partial F / \partial v_0)_e$. Из уравнения (\ref{eq:F_idm_definition}):
\[ F = a \left[1 - \left(\frac{v}{v_0}\right)^\delta - \left( \frac{s^*(v, \Delta v)}{s} \right)^2 \right] \]
\[ \frac{\partial F}{\partial v_0} = -a \cdot \delta \left(\frac{v}{v_0}\right)^{\delta-1} \cdot \left(-\frac{v}{v_0^2}\right) = a \frac{\delta v_0}{v_0} \left(\frac{v}{v_0}\right)^\delta = a \frac{\delta}{v_0} \left(\frac{v}{v_0}\right)^\delta. \]
В состоянии равновесия $(v_e, s_e, 0)$, используя (\ref{eq:equilibrium_final_form}) $\left(v_e/v_0\right)^\delta = 1 - \left( (s_0 + T v_e) / s_e \right)^2$, получаем:
\[ f_{v_0} = \left.\frac{\partial F}{\partial v_0}\right|_e = a \frac{\delta}{v_{0,e}} \left[ 1 - \left( \frac{s_0+v_eT}{s_e} \right)^2 \right]. \]
Поскольку в режиме свободного или не слишком плотного потока $s_e$ велико по сравнению с $s_0+v_eT$, выражение в скобках положительно, и $f_{v_0} > 0$. Это означает, что увеличение $v_0$ (вследствие увеличения $v_{VSL}$) приводит к положительному вкладу в ускорение, что является ожидаемым эффектом.

Теоретический анализ устойчивости и детальное моделирование помогают определить оптимальные параметры VSL-контроллеров, пороговые значения для их активации и логику переключения скоростных режимов для максимальной эффективности в предотвращении колебаний и улучшении характеристик транспортного потока.

Для наглядной демонстрации эффективности VSL-систем часто используется сравнение сценариев движения "без управления" и "с управлением VSL" для идентичных начальных условий или событий (например, инцидент или резкий рост интенсивности). На Рис. \ref{fig:vsl_comparison} (концептуально) представлено такое комплексное сравнение с использованием сетки 2x2 для различных типов графиков.

\begin{figure}[h!]
    \centering
    % Верхний ряд
    \begin{minipage}{0.48\textwidth}
        \centering
        % \includegraphics[width=\linewidth]{placeholder_heatmap_no_vsl.png} % Замените на имя файла
        \caption*{а) Тепловая карта скорости (без VSL)} % Используем caption* для подписи без нумерации "Рис."
        \label{fig:heatmap_no_vsl_alt} % Можно добавить альтернативный label, если нужна ссылка
    \end{minipage}\hfill
    \begin{minipage}{0.48\textwidth}
        \centering
        % \includegraphics[width=\linewidth]{placeholder_heatmap_with_vsl.png} % Замените на имя файла
        \caption*{б) Тепловая карта скорости (с VSL)}
        \label{fig:heatmap_with_vsl_alt}
    \end{minipage}

    \vspace{0.5cm} % Вертикальный отступ между рядами изображений

    % Нижний ряд
    \begin{minipage}{0.48\textwidth}
        \centering
        % \includegraphics[width=\linewidth]{placeholder_avg_speed_no_vsl.png} % Замените на имя файла
        \caption*{в) Средняя скорость (без VSL)}
        \label{fig:avg_speed_no_vsl_alt}
    \end{minipage}\hfill
    \begin{minipage}{0.48\textwidth}
        \centering
        % \includegraphics[width=\linewidth]{placeholder_avg_speed_with_vsl.png} % Замените на имя файла
        \caption*{г) Средняя скорость (с VSL)}
        \label{fig:avg_speed_with_vsl_alt}
    \end{minipage}

    \caption{Концептуальное сравнение сценариев движения: (а, в) без VSL и (б, г) с VSL. Верхний ряд (а, б): пространственно-временные тепловые карты скорости. Нижний ряд (в, г): графики средней скорости на контрольном участке.}
    \label{fig:vsl_comparison}
\end{figure}

В сценарии "без VSL" (представленном, например, на левых подграфиках Рис. \ref{fig:heatmap_no_vsl_alt} и Рис. \ref{fig:avg_speed_no_vsl_alt}) можно ожидать развития ярко выраженных волн "stop-and-go", что иллюстрируется характерными диагональными полосами на тепловой карте скорости, и значительного падения как средней скорости, так и пропускной способности. В сценарии "с VSL" (правые подграфики Рис. \ref{fig:heatmap_with_vsl_alt} и Рис. \ref{fig:avg_speed_with_vsl_alt}) активное управление скоростными режимами должно способствовать поддержанию более равномерного и стабильного потока. Это отразится в более однородной тепловой карте, более высоких и стабильных значениях на графиках средней скорости, предотвращая или существенно ослабляя колебания, даже если это означает некоторое снижение максимальных скоростей на отдельных участках до возникновения проблем. Результатом должно стать повышение общей эффективности, предсказуемости движения и, возможно, даже реальной пропускной способности за счет предотвращения "срыва потока".

\section{Заключение}
В данной главе были рассмотрены теоретические основы микроскопического моделирования транспортных потоков с акцентом на Интеллектуальную модель водителя (IDM). Подробно описаны уравнение движения IDM, физический смысл ее параметров и функция желаемой динамической дистанции. Проведен анализ равновесных состояний потока, показана связь между скоростью, зазором и параметрами модели, а также обсуждена возможность существования множественных состояний равновесия, приводящая к немонотонной фундаментальной диаграмме.

Центральной частью главы явился линейный анализ устойчивости модели IDM. Были выведены линеаризованные уравнения для малых возмущений и рассчитаны частные производные функции ускорения, определяющие чувствительность водителя к изменениям собственной скорости, зазора и относительной скорости с лидером. На основе этих производных проведен волновой анализ устойчивости однородного потока, включая анализ влияния времени реакции водителя, который показал его критическую роль в возникновении нестабильностей, особенно для коротковолновых возмущений. Рассмотрены понятия локальной (взводной) и струнной устойчивости, объяснен механизм возникновения фантомных заторов и волн "stop-and-go" как следствие струнной неустойчивости.

В завершение были кратко представлены теоретические основы для современных методов анализа и управления транспортными потоками, таких как алгоритмы обнаружения волн и системы управления переменными скоростными ограничениями (VSL), которые строятся на понимании динамики и устойчивости транспортного потока, описываемой моделями следования.

Представленный теоретический аппарат является фундаментом для дальнейшего численного моделирования, валидации моделей по реальным данным и разработки эффективных стратегий управления транспортными системами.

\ Hfill\break % Для новой страницы перед списком литературы, если он будет
% Список литературы (пример)
\begin{thebibliography}{9}
    \bibitem{treiber2000idm}
    Treiber, M., Hennecke, A., and Helbing, D. (2000).
    Congested traffic states in freeway traffic: empirical features and model-based explanations.
    \textit{Physical Review E}, 62(2), 1805--1824.

    \bibitem{treiber2013traffic}
    Treiber, M., and Kesting, A. (2013).
    \textit{Traffic Flow Dynamics: Data, Models and Simulation}.
    Springer-Verlag Berlin Heidelberg.
    
    \bibitem{kesting2010}
    Kesting, A., Treiber, M., and Helbing, D. (2010). 
    Enhanced intelligent driver model to access the impact of driving strategies on traffic capacity. 
    \textit{Philosophical Transactions of the Royal Society A: Mathematical, Physical and Engineering Sciences}, 368(1928), 4585-4605.

    \bibitem{helbing2001}
    Helbing, D. (2001). 
    Traffic and related self-driven many-particle systems. 
    \textit{Reviews of Modern Physics}, 73(4), 1067.

    \bibitem{sumo_manual}
    Alvarez Lopez, P., Behrisch, M., Bieker-Walz, L., Erdmann, J., Flötteröd, Y. P., Hilbrich, R., Lücken, L., Rummel, J., Wagner, P., and Wießner, E. (2018).
    Microscopic Traffic Simulation using SUMO.
    \textit{IEEE Intelligent Transportation Systems Conference (ITSC)}.

\end{thebibliography}

\end{document}