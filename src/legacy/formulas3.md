# Методология анализа устойчивости потока в модели **E‑IDM** с учётом реакционной задержки τ

> Цель — вычислить зависимость максимальной вещественной части характеристических показателей роста  
> \( \lambda_{\max}(T,\tau) \) от желаемого времени‑головки T при ненулевой задержке реакции τ и тем самым найти критическое значение \(T_{\text{cr}}\), при котором поток переходит от неустойчивого к устойчивому.

---

## 0. Входные параметры и обозначения

| Символ | Значение / единицы | Типичное |
|--------|---------------------|----------|
| \(q\)  | интенсивность (авт/с) | 0.7–0.8 |
| \(s_0\)| минимальный зазор, м | 2 |
| \(L\)  | длина ТС, м | 5 |
| \(T\)  | **переборное** желаемое время‑головка, с | 0.4–2 |
| \(a\)  | комфортное ускорение, м/с² | 2.6 |
| \(b\)  | комфортное торможение, м/с² | 4.5 |
| \(v_0\)| желаемая скорость, м/с | 33.3 |
| \(δ\)  | показатель степени (обычно 4) | 4 |
| \(τ\)  | **реакционная задержка**, с | 0 – 1 |

---

## Шаг 1. Численный поиск равновесия \((v_e,s_e)\)

1. **Скалярное уравнение**  
   \[
   G(v_e)=1-\Bigl(\tfrac{v_e}{v_0}\Bigr)^{\!δ}
          -\Bigl[\tfrac{s_0+Tv_e}{v_e/q-L}\Bigr]^{\!2}=0,
   \quad v_e\in(qL,v_0).
   \]
2. **Начальная точка**  
   \[
   v_e^{(0)}=\frac{q(s_0+L)}{1-qT}.
   \]
3. **Решатель** — Brent или Newton–Raphson (`scipy.optimize.brentq/newton`) с двухсторонними границами \((qL, v_0)\).
4. **Дистанция**  
   \[
   s_e=\frac{v_e}{q}-L.
   \]

---

## Шаг 2. Частные производные функции ускорения

\[
A=\frac{2a}{s_e},\qquad
B=a\!\left[\delta\Bigl(\tfrac{v_e}{v_0}\Bigr)^{\!δ-1}\!\frac{1}{v_0}+\frac{2T}{s_e}\right],
\qquad
C=\frac{a\,v_e}{\sqrt{ab}\,s_e}.
\]

---

## Шаг 3. Линеаризация цепочки **с задержкой τ**

При возмущениях вида  
\( \delta v_i, \delta s_i \propto e^{\lambda t + jki} \)  
(волновое число \(k\in(0,\pi]\)) линейное уравнение движения
с запаздыванием даёт **трансцендентное** характеристическое уравнение  
\[
\boxed{%
\lambda^{2}e^{\lambda\tau}
-\lambda\!\bigl[B+C\,(1-e^{-jk})\bigr]
- A\,(e^{-jk}-1)=0}.
\tag{†}
\]

- При \(τ=0\) формула (†) переходит в классическое квадратичное уравнение.

---

## Шаг 4. Численный поиск корней \(\lambda(k,\tau)\)

1. Формируем равномерную решётку  
   \(k_m = m\pi/N_k,\; m=1..N_k\) (рекомендуется \(N_k = 200\)–400).  
2. Для каждого \(k_m\) решаем (†) по \(\lambda\):
   - Начальный guess — решения без τ.
   - Комплексный Newton или Brent по Re и Im отдельно.  
3. Сохраняем  
   \[
   \lambda_{\max}(T,\tau) = \max_{k_m}\bigl(\max\_i \operatorname{Re}\lambda_i(k_m)\bigr).
   \]

---

## Шаг 5. Поиск критического времени‑головки \(T_{\text{cr}}(τ)\)

1. Задаём сетку \(T_n\) (шаг ~0.02 с).  
2. Выполняем Шаги 1‑4 для каждого \(T_n\).  
3. Находим соседние узлы, где  
   \( \lambda_{\max}(T_{n}) > 0,\; \lambda_{\max}(T_{n+1}) < 0 \)  
   и интерполируем:
   \[
   T_{\text{cr}}\approx T_n-\frac{\lambda_{\max}(T_n)}%
   {\lambda_{\max}(T_{n+1})-\lambda_{\max}(T_n)}\,(T_{n+1}-T_n).
   \]

---

## Численные настройки и рекомендации

| Параметр | Значение / совет |
|----------|-----------------|
| `N_k`    | 200 – 400 (π‑решётка) |
| Абсолютная точность `ε` | 10⁻⁸ для корней G, 10⁻⁶ для (†) |
| Максимум итераций | 50 (Newton), 100 (Brent) |
| Проверка | при \(τ→0\) результаты должны совпасть с квадратичным случаем |

---

## Проверка корректности

1. **Лимит τ → 0**: \( \lambda_{\max}(T,τ)\to\lambda_{\max}^{(τ=0)}(T)\).  
2. **Низкие плотности**: \( T_{\text{cr}} \approx 2\sqrt{ab}/a \) (классика IDM).  
3. **Непрерывность**: \( \lambda_{\max}(T) \) должна изменяться гладко без скачков — иначе увеличить `N_k` или точность root‑finder’а.

---

## Интерпретация результатов

- **Если \( \lambda_{\max}(T,\tau) > 0 \)** → поток линейно неустойчив, возмущения растут.  
- **Если \( \lambda_{\max}(T,\tau) < 0 \)** → возмущения затухают, поток устойчив.  
- Рост τ **увеличивает** \(T_{\text{cr}}\): при твоих параметрах  
  \(τ=0.0 с ⇒ T_{\text{cr}}\approx1.17 с\)  
  \(τ=0.8 с ⇒ T_{\text{cr}}\approx1.26–1.30 с\).

---

### Файловая структура реализации (Python + SciPy)

